library(tidyverse)
library(data.table)
library(glue)
library(ggpubr)
qPCR_227 = fread("bak_coeae1f.txt")
View(qPCR_227)
qPCR_227 = fread("bak_coeae1f.txt")
View(qPCR_227)
qPCR_227 = fread("bak_coeae1f.txt")
qPCR_227 = fread("bak_coeae1f.txt")
qPCR_227 = fread("bak_coeae1f.txt", header = FALSE)
View(qPCR_227)
colnames(qPCR_227)
View(qPCR_227)
View(qPCR_227)
qPCR_227 = fread("bak_coeae1f.txt", header = FALSE) %>% select('V1', 'V4')
source('~/.active-rstudio-document', echo=TRUE)
View(qPCR_227)
fwrite(qPCR_227, "qPCR_227.csv")
56.8/8
qPCR_227 = fread("qPCR_227.csv", header = FALSE)
qPCR_227
head(qPCR_227)
qPCR_227 = fread("qPCR_227.csv")
qPCR_227
head(qPCR_227)
### check the correct number of samples in each gene and sample ###
table(qPCR_227$Gene)
table(qPCR_227$Sample)
table(qPCR_227$Strain)
View(qPCR_227)
qPCR_227 = fread("qPCR_227.csv") %>% rename('Cq' = 'Ct')
qPCR_227
head(qPCR_227)
### check the correct number of samples in each gene and sample ###
table(qPCR_227$Gene)
table(qPCR_227$Strain)
COEAE1F = qPCR_227 %>% filter(Gene == 'COEAE1F') %>%
select(-Well) %>%
group_by_at(vars(-Cq)) %>%
summarise(Cq=mean(Cq))
View(COEAE1F)
qPCR_227 = fread("qPCR_227.csv")
qPCR_227
head(qPCR_227)
### check the correct number of samples in each gene and sample ###
table(qPCR_227$Gene)
table(qPCR_227$Strain)
table(qPCR_227$Sample)
COEAE1F = qPCR_227 %>% filter(Gene == 'COEAE1F') %>%
select(-Well) %>%
group_by_at(vars(-Cq)) %>%
summarise(Cq=mean(Cq))
EF = qPCR_227 %>% filter(Gene == 'EF') %>%
mutate('sample_gene' = paste0(Sample, "_",Gene)) %>%
select(-Well, -PlateID) %>%
group_by_at(vars(-Cq)) %>%
summarise(Cq=mean(Cq))
View(COEAE1F)
COEAE1F = qPCR_227 %>% filter(Gene == 'COEAE1F') %>%
mutate('sample_gene' = paste0(Sample, "_",Gene)) %>%
select(-Well) %>%
group_by_at(vars(-Cq)) %>%
summarise(Cq=mean(Cq))
View(COEAE1F)
COEAE1F = qPCR_227 %>% filter(Gene == 'COEAE1F') %>%
select(-Well) %>%
group_by_at(vars(-Cq)) %>%
summarise(Cq=mean(Cq))
EF = qPCR_227 %>% filter(Gene == 'EF') %>%
select(-Well, -PlateID) %>%
group_by_at(vars(-Cq)) %>%
summarise(Cq=mean(Cq))
COEAE1F = qPCR_227 %>% filter(Gene == 'COEAE1F') %>%
select(-Well) %>%
group_by_at(vars(-Cq)) %>%
summarise(Cq=mean(Cq))
EF = qPCR_227 %>% filter(Gene == 'EF') %>%
select(-Well) %>%
group_by_at(vars(-Cq)) %>%
summarise(Cq=mean(Cq))
S7 = qPCR_227 %>% filter(Gene == 'S7') %>%
select(-Well) %>%
group_by_at(vars(-Cq)) %>%
summarise(Cq=mean(Cq))
View(EF)
View(S7)
View(S7)
View(S7)
View(COEAE1F)
View(EF)
#average reference values for each sample
refs = (S7$Cq+EF$Cq)/2
#calculate delta CT values by taking ref average and substracting Cq of 6aa1
COEAE1F$deltaCT = refs-COEAE1F$Cq
View(COEAE1F)
#subset to each group
COEAE1F_BAK = COEAE1F[COEAE1F$Strain == 'Bakaridjan',]
COEAE1F_KIS = COEAE1F[COEAE1F$Strain == 'Kisumu',]
View(COEAE1F_BAK)
View(COEAE1F_KIS)
View(COEAE1F)
View(EF)
View(S7)
#### sd and confidence interval s
errdup = sd(COEAE1F_BAK$deltaCT) *1.96 /sqrt(8)
errhet = sd(COEAE1F_KIS$deltaCT) *1.96 / sqrt(8)
#### sd and confidence interval s
errbak = sd(COEAE1F_BAK$deltaCT) *1.96 /sqrt(8)
errkis = sd(COEAE1F_KIS$deltaCT) *1.96 / sqrt(8)
#### get fold changes
COEAE1F_BAK_mean = mean(COEAE1F_BAK$deltaCT)
COEAE1F_KIS_mean = mean(COEAE1F_KIS$deltaCT)
2^CCOEAE1F_BAK_mean
#### get fold changes
COEAE1F_BAK_mean = mean(COEAE1F_BAK$deltaCT)
COEAE1F_KIS_mean = mean(COEAE1F_KIS$deltaCT)
2^CCOEAE1F_BAK_mean
2^COEAE1F_BAK_mean
2^COEAE1F_BAK_mean
2^COEAE1F_KIS_mean
### get condifence intervals
bak_lower = 2^((COEAE1F_BAK_mean - errdup) - COEAE1F_KIS_mean)
### get condifence intervals
bak_lower = 2^((COEAE1F_BAK_mean - errbak) - COEAE1F_KIS_mean)
bak_upper = 2^((COEAE1F_BAK_mean + errbak) - COEAE1F_KIS_mean)
kis_lower = 2^((COEAE1F_KIS_mean - errkis) - COEAE1F_KIS_mean)
kis_upper = 2^((COEAE1F_KIS_mean + errkis) - COEAE1F_KIS_mean)
### get delta delta Ct values (log fold change to base amplication efficiency)
BAK_KIS = COEAE1F_BAK_mean-COEAE1F_KIS_mean
KIS_BAK = COEAE1F_KIS_mean-COEAE1F_BAK_mean
KIS_KIS = COEAE1F_KIS_mean-COEAE1F_KIS_mean
## get fold change
FCBak_Kis = 2^BAK_KIS
FCBak_Kis
2^KIS_BAK
View(COEAE1F_BAK)
View(EF)
View(S7)
View(S7)
S7$Cq
EF$Cq
EF[3,4]
EF[3,4] = 30
ef
EF
#average reference values for each sample
refs = (S7$Cq+EF$Cq)/2
#calculate delta CT values by taking ref average and substracting Cq of 6aa1
COEAE1F$deltaCT = refs-COEAE1F$Cq
#subset to each group
COEAE1F_BAK = COEAE1F[COEAE1F$Strain == 'Bakaridjan',]
COEAE1F_KIS = COEAE1F[COEAE1F$Strain == 'Kisumu',]
#### sd and confidence interval s
errbak = sd(COEAE1F_BAK$deltaCT) *1.96 /sqrt(8)
errkis = sd(COEAE1F_KIS$deltaCT) *1.96 / sqrt(8)
#### get f
COEAE1F_BAK_mean = mean(COEAE1F_BAK$deltaCT)
COEAE1F_KIS_mean = mean(COEAE1F_KIS$deltaCT)
### get condifence intervals
bak_lower = 2^((COEAE1F_BAK_mean - errbak) - COEAE1F_KIS_mean)
bak_upper = 2^((COEAE1F_BAK_mean + errbak) - COEAE1F_KIS_mean)
kis_lower = 2^((COEAE1F_KIS_mean - errkis) - COEAE1F_KIS_mean)
kis_upper = 2^((COEAE1F_KIS_mean + errkis) - COEAE1F_KIS_mean)
### get delta delta Ct values (log fold change to base amplication efficiency)
BAK_KIS = COEAE1F_BAK_mean-COEAE1F_KIS_mean
KIS_BAK = COEAE1F_KIS_mean-COEAE1F_BAK_mean
KIS_KIS = COEAE1F_KIS_mean-COEAE1F_KIS_mean
## get fold change
FCBak_Kis = 2^BAK_KIS
FCBak_Kis
2^KIS_BAK
library(ggpubr)
qPCR_227 = fread("qPCR_227.csv")
qPCR_227
head(qPCR_227)
### check the correct number of samples in each gene and sample ###
table(qPCR_227$Gene)
table(qPCR_227$Strain)
table(qPCR_227$Sample)
COEAE1F = qPCR_227 %>% filter(Gene == 'COEAE1F') %>%
select(-Well) %>%
group_by_at(vars(-Cq)) %>%
summarise(Cq=mean(Cq))
EF = qPCR_227 %>% filter(Gene == 'EF') %>%
select(-Well) %>%
group_by_at(vars(-Cq)) %>%
summarise(Cq=mean(Cq))
S7 = qPCR_227 %>% filter(Gene == 'S7') %>%
select(-Well) %>%
group_by_at(vars(-Cq)) %>%
summarise(Cq=mean(Cq))
EF$Cq
#average reference values for each sample
refs = (S7$Cq+EF$Cq)/2
#calculate delta CT values by taking ref average and substracting Cq of 6aa1
COEAE1F$deltaCT = refs-COEAE1F$Cq
#subset to each group
COEAE1F_BAK = COEAE1F[COEAE1F$Strain == 'Bakaridjan',]
COEAE1F_KIS = COEAE1F[COEAE1F$Strain == 'Kisumu',]
#### sd and confidence interval s
errbak = sd(COEAE1F_BAK$deltaCT) *1.96 /sqrt(8)
errkis = sd(COEAE1F_KIS$deltaCT) *1.96 / sqrt(8)
#### get f
COEAE1F_BAK_mean = mean(COEAE1F_BAK$deltaCT)
COEAE1F_KIS_mean = mean(COEAE1F_KIS$deltaCT)
### get condifence intervals
bak_lower = 2^((COEAE1F_BAK_mean - errbak) - COEAE1F_KIS_mean)
bak_upper = 2^((COEAE1F_BAK_mean + errbak) - COEAE1F_KIS_mean)
kis_lower = 2^((COEAE1F_KIS_mean - errkis) - COEAE1F_KIS_mean)
kis_upper = 2^((COEAE1F_KIS_mean + errkis) - COEAE1F_KIS_mean)
### get delta delta Ct values (log fold change to base amplication efficiency)
BAK_KIS = COEAE1F_BAK_mean-COEAE1F_KIS_mean
KIS_BAK = COEAE1F_KIS_mean-COEAE1F_BAK_mean
KIS_KIS = COEAE1F_KIS_mean-COEAE1F_KIS_mean
## get fold change
FCBak_Kis = 2^BAK_KIS
FCBak_Kis
2^KIS_BAK
2^KIS_BAK
FC = data.frame("Bakaridjan"= FCBak_Kis)
FC = gather(FC, "Genotype", "Fold Change")
FC$lower = c(dup_lower, het_lower, wt_lower)
FC$lower = c(bak_lower)
FC$upper = c(bak_upper)
##### perform pairwise students t test for each comparison on deltaCTs####
t.test(COEAE1F_BAK$deltaCT, COEAE1F_KIS$deltaCT)
View(COEAE1F_BAK)
### ggpubr t test for plotting significance *** ### same results (not needed in end)
compare_means(deltaCT ~ group,
data=COEAE1F,  method="t.test")
### ggpubr t test for plotting significance *** ### same results (not needed in end)
compare_means(deltaCT ~ Strain,
data=COEAE1F,  method="t.test")
View(COEAE1F)
View(FC)
View(FC)
install.packages("docopt")
install.packages("littler")
library(littler)
library(docopt)
